<a name="br1"></a> 

My Project

Generated by Doxygen 1.9.8



<a name="br2"></a> 



<a name="br3"></a> 

i

1 Topic Index

1\.1 Topics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1

1

2 File Index

2\.1 File List . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3

3

3 Topic Documentation

5

5

5

5

5

5

6

6

6

6

6

6

3\.1 CMSIS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3\.1.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3\.1.2 Stm32g4xx\_system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3\.1.2.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3\.1.2.2 STM32G4xx\_System\_Private\_Includes . . . . . . . . . . . . . . . . . . . . . . .

3\.1.2.3 STM32G4xx\_System\_Private\_TypesDeﬁnitions . . . . . . . . . . . . . . . . . . .

3\.1.2.4 STM32G4xx\_System\_Private\_Deﬁnes . . . . . . . . . . . . . . . . . . . . . . . .

3\.1.2.5 STM32G4xx\_System\_Private\_Macros . . . . . . . . . . . . . . . . . . . . . . . .

3\.1.2.6 STM32G4xx\_System\_Private\_Variables . . . . . . . . . . . . . . . . . . . . . . .

3\.1.2.7 STM32G4xx\_System\_Private\_FunctionPrototypes . . . . . . . . . . . . . . . . .

3\.1.2.8 STM32G4xx\_System\_Private\_Functions . . . . . . . . . . . . . . . . . . . . . . .

4 File Documentation

9

9

9

4\.1 adc.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4\.1.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4\.1.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

4\.1.2.1 HAL\_ADC\_MspDeInit() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

4\.1.2.2 HAL\_ADC\_MspInit() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

4\.1.2.3 MX\_ADC1\_Init() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

4\.1.2.4 MX\_ADC2\_Init() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

4\.2 adc\_mes.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

4\.2.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

4\.2.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

4\.2.2.1 Adc\_init() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

4\.2.2.2 Mes\_Courant() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

4\.2.2.3 Mesure\_Vitesse() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

4\.3 dma.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

4\.3.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

4\.3.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

4\.3.2.1 MX\_DMA\_Init() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

4\.4 gpio.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

4\.4.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

4\.4.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

4\.4.2.1 MX\_GPIO\_Init() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

4\.5 main.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

4\.5.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

Generated by Doxygen



<a name="br4"></a> 

ii

4\.5.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

4\.5.2.1 Error\_Handler() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

4\.5.2.2 HAL\_ADC\_ConvCpltCallback() . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

4\.5.2.3 HAL\_TIM\_PeriodElapsedCallback() . . . . . . . . . . . . . . . . . . . . . . . . . 16

4\.5.2.4 HAL\_UART\_RxCpltCallback() . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

4\.5.2.5 main() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

4\.5.2.6 SystemClock\_Conﬁg() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

4\.6 motor.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

4\.6.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

4\.6.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

4\.6.2.1 Change\_Speed() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

4\.6.2.2 Start\_Motor() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

4\.6.2.3 Stop\_Motor() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

4\.7 shell.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

4\.7.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

4\.7.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

4\.7.2.1 UART\_Echo() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

4\.7.3 Variable Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

4\.7.3.1 help . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

4\.8 stm32g4xx\_hal\_msp.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

4\.8.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

4\.8.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

4\.8.2.1 HAL\_MspInit() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

4\.9 stm32g4xx\_hal\_timebase\_tim.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22

4\.9.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22

4\.9.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22

4\.9.2.1 HAL\_InitTick() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22

4\.9.2.2 HAL\_ResumeTick() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23

4\.9.2.3 HAL\_SuspendTick() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23

4\.10 stm32g4xx\_it.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

4\.10.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

4\.11 syscalls.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

4\.11.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

4\.12 sysmem.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

4\.12.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

4\.12.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27

4\.12.2.1 \_sbrk() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27

4\.13 system\_stm32g4xx.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27

4\.13.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2 This ﬁle conﬁgures the system clock as follows: . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.1 System Clock source | HSI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.2 SYSCLK(Hz) | 16000000 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

Generated by Doxygen



<a name="br5"></a> 

iii

4\.13.2.3 HCLK(Hz) | 16000000 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.4 AHB Prescaler | 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.5 APB1 Prescaler | 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.6 APB2 Prescaler | 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.7 PLL\_M | 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.8 PLL\_N | 16 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.9 PLL\_P | 7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.10 PLL\_Q | 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.11 PLL\_R | 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.13.2.12 Require 48MHz for RNG | Disabled . . . . . . . . . . . . . . . . . . . . . . . . 28

4\.14 tim.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

4\.14.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

4\.14.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

4\.14.2.1 HAL\_TIM\_Encoder\_MspDeInit() . . . . . . . . . . . . . . . . . . . . . . . . . . 29

4\.14.2.2 HAL\_TIM\_Encoder\_MspInit() . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

4\.14.2.3 HAL\_TIM\_MspPostInit() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

4\.15 usart.c File Reference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

4\.15.1 Detailed Description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

4\.15.2 Function Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

4\.15.2.1 HAL\_UART\_MspDeInit() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

4\.15.2.2 HAL\_UART\_MspInit() . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

Index

31

Generated by Doxygen



<a name="br6"></a> 



<a name="br7"></a> 

Chapter 1

Topic Index

1\.1 Topics

Here is a list of all topics with brief descriptions:

CMSIS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

Stm32g4xx\_system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

STM32G4xx\_System\_Private\_Includes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

STM32G4xx\_System\_Private\_TypesDeﬁnitions . . . . . . . . . . . . . . . . . . . . . . . . . . .

STM32G4xx\_System\_Private\_Deﬁnes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

STM32G4xx\_System\_Private\_Macros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

STM32G4xx\_System\_Private\_Variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

STM32G4xx\_System\_Private\_FunctionPrototypes . . . . . . . . . . . . . . . . . . . . . . . . . .

STM32G4xx\_System\_Private\_Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

5

6

6

6

6

6

6

Generated by Doxygen



<a name="br8"></a> 

2

Topic Index

Generated by Doxygen



<a name="br9"></a> 

Chapter 2

File Index

2\.1 File List

Here is a list of all documented ﬁles with brief descriptions:

adc.c

This ﬁle provides code for the conﬁguration of the ADC instances . . . . . . . . . . . . . . . .

9

adc\_mes.c

Mesures du courant et de la vitesse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

dma.c

This ﬁle provides code for the conﬁguration of all the requested memory to memory DMA trans-

fers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

gpio.c

main.c

motor.c

shell.c

This ﬁle provides code for the conﬁguration of all used GPIO pins . . . . . . . . . . . . . . . . 13

: Main program body . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

Gère la commande du moteur . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

Création du shell qui va permettre d'entrer les consignes du moteur . . . . . . . . . . . . . . 19

stm32g4xx\_hal\_msp.c

This ﬁle provides code for the MSP Initialization and de-Initialization codes . . . . . . . . . . . 21

stm32g4xx\_hal\_timebase\_tim.c

HAL time base based on the hardware TIM . . . . . . . . . . . . . . . . . . . . . . . . . . . 22

stm32g4xx\_it.c

Interrupt Service Routines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

syscalls.c

STM32CubeIDE Minimal System calls ﬁle . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

sysmem.c

STM32CubeIDE System Memory calls ﬁle . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

system\_stm32g4xx.c

CMSIS Cortex-M4 Device Peripheral Access Layer System Source File . . . . . . . . . . . . 27

tim.c

This ﬁle provides code for the conﬁguration of the TIM instances . . . . . . . . . . . . . . . . 29

This ﬁle provides code for the conﬁguration of the USART instances . . . . . . . . . . . . . . 29

usart.c

Generated by Doxygen



<a name="br10"></a> 

4

File Index

Generated by Doxygen



<a name="br11"></a> 

Chapter 3

Topic Documentation

3\.1 CMSIS

Modules

•

Stm32g4xx\_system

3\.1.1 Detailed Description

3\.1.2 Stm32g4xx\_system

Modules

•

•

•

•

•

•

•

STM32G4xx\_System\_Private\_Includes

STM32G4xx\_System\_Private\_TypesDeﬁnitions

STM32G4xx\_System\_Private\_Deﬁnes

STM32G4xx\_System\_Private\_Macros

STM32G4xx\_System\_Private\_Variables

STM32G4xx\_System\_Private\_FunctionPrototypes

STM32G4xx\_System\_Private\_Functions

3\.1.2.1 Detailed Description

3\.1.2.2 STM32G4xx\_System\_Private\_Includes

Macros

• #deﬁne HSE\_VALUE 24000000U

• #deﬁne HSI\_VALUE 16000000U

Generated by Doxygen



<a name="br12"></a> 

6

Topic Documentation

3\.1.2.2.1 Detailed Description

3\.1.2.2.2 Macro Deﬁnition Documentation

3\.1.2.2.2.1 HSE\_VALUE

#define HSE\_VALUE 24000000U

Value of the External oscillator in Hz

3\.1.2.2.2.2 HSI\_VALUE

#define HSI\_VALUE 16000000U

Value of the Internal oscillator in Hz

3\.1.2.3 STM32G4xx\_System\_Private\_TypesDeﬁnitions

3\.1.2.4 STM32G4xx\_System\_Private\_Deﬁnes

3\.1.2.5 STM32G4xx\_System\_Private\_Macros

3\.1.2.6 STM32G4xx\_System\_Private\_Variables

Variables

• uint32\_t SystemCoreClock = HSI\_VALUE

• const uint8\_t AHBPrescTable [16] = {0U, 0U, 0U, 0U, 0U, 0U, 0U, 0U, 1U, 2U, 3U, 4U, 6U, 7U, 8U, 9U}

• const uint8\_t APBPrescTable [8] = {0U, 0U, 0U, 0U, 1U, 2U, 3U, 4U}

3\.1.2.6.1 Detailed Description

3\.1.2.7 STM32G4xx\_System\_Private\_FunctionPrototypes

3\.1.2.8 STM32G4xx\_System\_Private\_Functions

Functions

• void SystemInit (void)

Setup the microcontroller system.

• void SystemCoreClockUpdate (void)

Update SystemCoreClock variable according to Clock Register Values. The SystemCoreClock variable contains the

core clock (HCLK), it can be used by the user application to setup the SysTick timer or conﬁgure other parameters.

Generated by Doxygen



<a name="br13"></a> 

3\.1 CMSIS

7

3\.1.2.8.1 Detailed Description

3\.1.2.8.2 Function Documentation

3\.1.2.8.2.1 SystemCoreClockUpdate()

void SystemCoreClockUpdate (

void

)

Update SystemCoreClock variable according to Clock Register Values. The SystemCoreClock variable contains the

core clock (HCLK), it can be used by the user application to setup the SysTick timer or conﬁgure other parameters.

Note

Each time the core clock (HCLK) changes, this function must be called to update SystemCoreClock variable

value. Otherwise, any conﬁguration based on this variable will be incorrect.

\- The system frequency computed by this function is not the real frequency in the chip. It is calculated based

on the predeﬁned constant and the selected clock source:

• If SYSCLK source is HSI, SystemCoreClock will contain the HSI\_VALUE(∗∗) (p. 6)

• If SYSCLK source is HSE, SystemCoreClock will contain the HSE\_VALUE(∗∗∗) (p. 6)

• If SYSCLK source is PLL, SystemCoreClock will contain the HSE\_VALUE(∗∗∗) (p. 6) or HSI\_VALUE(∗) (p. 6)

multiplied/divided by the PLL factors.

(∗∗) HSI\_VALUE is a constant deﬁned in stm32g4xx\_hal.h ﬁle (default value 16 MHz) but the real value may vary

depending on the variations in voltage and temperature.

(∗∗∗) HSE\_VALUE is a constant deﬁned in stm32g4xx\_hal.h ﬁle (default value 24 MHz), user has to ensure that

HSE\_VALUE is same as the real frequency of the crystal used. Otherwise, this function may have wrong result.

• The result of this function could be not correct when using fractional value for HSE crystal.

Parameters

None

Return values

None

3\.1.2.8.2.2 SystemInit()

void SystemInit (

void

)

Setup the microcontroller system.

Generated by Doxygen



<a name="br14"></a> 

8

Topic Documentation

Parameters

None

Return values

None

Generated by Doxygen



<a name="br15"></a> 

Chapter 4

File Documentation

4\.1 adc.c File Reference

This ﬁle provides code for the conﬁguration of the ADC instances.

#include "adc.h"

Functions

• void MX\_ADC1\_Init (void)

• void MX\_ADC2\_Init (void)

• void HAL\_ADC\_MspInit (ADC\_HandleTypeDef ∗adcHandle)

• void HAL\_ADC\_MspDeInit (ADC\_HandleTypeDef ∗adcHandle)

Variables

• ADC\_HandleTypeDef hadc1

• ADC\_HandleTypeDef hadc2

• DMA\_HandleTypeDef hdma\_adc1

4\.1.1 Detailed Description

This ﬁle provides code for the conﬁguration of the ADC instances.

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

Generated by Doxygen



<a name="br16"></a> 

10

File Documentation

4\.1.2 Function Documentation

4\.1.2.1 HAL\_ADC\_MspDeInit()

void HAL\_ADC\_MspDeInit (

ADC\_HandleTypeDef ∗ adcHandle )

ADC1 GPIO Conﬁguration PC2 ---—> ADC1\_IN8 PA1 ---—> ADC1\_IN2 PB0 ---—> ADC1\_IN15 PB1 ---—>

ADC1\_IN12

ADC2 GPIO Conﬁguration PC0 ---—> ADC2\_IN6 PC1 ---—> ADC2\_IN7 PC3 ---—> ADC2\_IN9 PA0 ---—>

ADC2\_IN1

4\.1.2.2 HAL\_ADC\_MspInit()

void HAL\_ADC\_MspInit (

ADC\_HandleTypeDef ∗ adcHandle )

Initializes the peripherals clocks

ADC1 GPIO Conﬁguration PC2 ---—> ADC1\_IN8 PA1 ---—> ADC1\_IN2 PB0 ---—> ADC1\_IN15 PB1 ---—>

ADC1\_IN12

Initializes the peripherals clocks

ADC2 GPIO Conﬁguration PC0 ---—> ADC2\_IN6 PC1 ---—> ADC2\_IN7 PC3 ---—> ADC2\_IN9 PA0 ---—>

ADC2\_IN1

4\.1.2.3 MX\_ADC1\_Init()

void MX\_ADC1\_Init (

void

)

Common conﬁg

Conﬁgure the ADC multi-mode

Conﬁgure Regular Channel

4\.1.2.4 MX\_ADC2\_Init()

void MX\_ADC2\_Init (

void

)

Common conﬁg

Conﬁgure Regular Channel

Generated by Doxygen



<a name="br17"></a> 

4\.2 adc\_mes.c File Reference

11

4\.2 adc\_mes.c File Reference

mesures du courant et de la vitesse

#include "main.h"

#include "adc\_mes.h"

#include "adc.h"

#include <stdio.h>

Macros

• #deﬁne ADC\_BUFFER 1

Functions

• void Adc\_init (void)

Initialisation de l'ADC.

• int32\_t Mes\_Courant (void)

Mesure le courant et le convertit en mA.

• int32\_t Mesure\_Vitesse (void)

Mesure la vitesse de rotation du moteur et la convertit en tr/min.

Variables

• ADC\_HandleTypeDef hadc1

• UART\_HandleTypeDef huart2

• TIM\_HandleTypeDef htim1

• TIM\_HandleTypeDef htim3

• int sens\_rotation

• const uint8\_t error\_calib [ ] = "Can't calibrate adc\r\n"

• const uint8\_t error\_start [ ] = "Can't start adc\r\n"

• uint32\_t courant\_mes

• uint32\_t val\_vitesse\_t0

• uint32\_t val\_vitesse\_t1

• int32\_t val\_vitesse

4\.2.1 Detailed Description

mesures du courant et de la vitesse

Author

Colin L, Lucas G

Version

1

Date

20 octobre 2023

Generated by Doxygen



<a name="br18"></a> 

12

File Documentation

4\.2.2 Function Documentation

4\.2.2.1 Adc\_init()

void Adc\_init (

void

)

Initialisation de l'ADC.

Parameters

void

Returns

void

4\.2.2.2 Mes\_Courant()

int32\_t Mes\_Courant (

void

)

Mesure le courant et le convertit en mA.

Parameters

void

Returns

courant\_mA la valeur du courant mesuré en mA

4\.2.2.3 Mesure\_Vitesse()

int32\_t Mesure\_Vitesse (

void

)

Mesure la vitesse de rotation du moteur et la convertit en tr/min.

Parameters

void

Returns

val\_vitesse la valeur de la vitesse de rotation mesurée en tr/min

Generated by Doxygen



<a name="br19"></a> 

4\.3 dma.c File Reference

13

4\.3 dma.c File Reference

This ﬁle provides code for the conﬁguration of all the requested memory to memory DMA transfers.

#include "dma.h"

Functions

• void MX\_DMA\_Init (void)

4\.3.1 Detailed Description

This ﬁle provides code for the conﬁguration of all the requested memory to memory DMA transfers.

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

4\.3.2 Function Documentation

4\.3.2.1 MX\_DMA\_Init()

void MX\_DMA\_Init (

void

)

Enable DMA controller clock

4\.4 gpio.c File Reference

This ﬁle provides code for the conﬁguration of all used GPIO pins.

#include "gpio.h"

Functions

• void MX\_GPIO\_Init (void)

Generated by Doxygen



<a name="br20"></a> 

14

File Documentation

4\.4.1 Detailed Description

This ﬁle provides code for the conﬁguration of all used GPIO pins.

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

4\.4.2 Function Documentation

4\.4.2.1 MX\_GPIO\_Init()

void MX\_GPIO\_Init (

void

)

Conﬁgure pins as Analog Input Output EVENT\_OUT EXTI

4\.5 main.c File Reference

: Main program body

#include "main.h"

#include "adc.h"

#include "dma.h"

#include "tim.h"

#include "usart.h"

#include "gpio.h"

#include <string.h>

#include "shell.h"

#include "motor.h"

#include "adc\_mes.h"

Functions

• void SystemClock\_Conﬁg (void)

System Clock Conﬁguration.

• void HAL\_UART\_RxCpltCallback (UART\_HandleTypeDef ∗huart)

Attend qu'un caractère soit entré par l'utilisateur et renvoie vers la fonction d'echo dans la boucle du main.

• void HAL\_ADC\_ConvCpltCallback (ADC\_HandleTypeDef ∗hadc)

Fonction d'asservissement du courant.

• int main (void)

The application entry point.

• void HAL\_TIM\_PeriodElapsedCallback (TIM\_HandleTypeDef ∗htim)

Period elapsed callback in non blocking mode.

• void Error\_Handler (void)

This function is executed in case of error occurrence.

Generated by Doxygen



<a name="br21"></a> 

4\.5 main.c File Reference

Variables

15

• int it\_uart = 0

• char buffer\_cmd [ ]

• uint8\_t started [ ]

• uint8\_t newLine [ ]

• uint32\_t uartRxReceived

• uint8\_t uartRxBuffer [UART\_RX\_BUFFER\_SIZE]

• uint8\_t uartTxBuffer [UART\_TX\_BUFFER\_SIZE]

4\.5.1 Detailed Description

: Main program body

ﬁchier principal

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

Author

Colin L, Lucas G

Version

1

Date

20 octobre 2023

4\.5.2 Function Documentation

4\.5.2.1 Error\_Handler()

void Error\_Handler (

void

)

This function is executed in case of error occurrence.

Return values

None

Generated by Doxygen



<a name="br22"></a> 

16

File Documentation

4\.5.2.2 HAL\_ADC\_ConvCpltCallback()

void HAL\_ADC\_ConvCpltCallback (

ADC\_HandleTypeDef ∗ hadc )

Fonction d'asservissement du courant.

Parameters

∗adc

Returns

void

4\.5.2.3 HAL\_TIM\_PeriodElapsedCallback()

void HAL\_TIM\_PeriodElapsedCallback (

TIM\_HandleTypeDef ∗ htim )

Period elapsed callback in non blocking mode.

Note

This function is called when TIM6 interrupt took place, inside HAL\_TIM\_IRQHandler(). It makes a direct call

to HAL\_IncTick() to increment a global variable "uwTick" used as application time base.

Parameters

htim : TIM handle

Return values

None

4\.5.2.4 HAL\_UART\_RxCpltCallback()

void HAL\_UART\_RxCpltCallback (

UART\_HandleTypeDef ∗ huart )

Attend qu'un caractère soit entré par l'utilisateur et renvoie vers la fonction d'echo dans la boucle du main.

Parameters

∗huart

Generated by Doxygen



<a name="br23"></a> 

4\.6 motor.c File Reference

17

Returns

void

4\.5.2.5 main()

int main (

void

)

The application entry point.

Return values

int

4\.5.2.6 SystemClock\_Conﬁg()

void SystemClock\_Config (

void

)

System Clock Conﬁguration.

Return values

None

Conﬁgure the main internal regulator output voltage

Initializes the RCC Oscillators according to the speciﬁed parameters in the RCC\_OscInitTypeDef structure.

Initializes the CPU, AHB and APB buses clocks

4\.6 motor.c File Reference

gère la commande du moteur

#include "motor.h"

#include "main.h"

#include "adc\_mes.h"

Functions

• void Change\_Speed (char cmd[CMD\_BUFFER\_SIZE])

Modiﬁe le rapport cyclique des PWM pour changer la vitesse de rotation du moteur.

• void Start\_Motor (char cmd[CMD\_BUFFER\_SIZE])

Démare les PWM avec une valeur de rapport cyclique de base de 500 pour assurer un vitesse de rotation nulle au

démarage.

• void Stop\_Motor (void)

stop les PWM et donc arrête le moteur

Generated by Doxygen



<a name="br24"></a> 

18

File Documentation

Variables

• UART\_HandleTypeDef huart2

• TIM\_HandleTypeDef htim1

• int speed\_buffer [4]

• const uint8\_t maxSpeed [ ] = "Too fast ! 'speed xxxx'"

• const uint8\_t speedChangedFin [ ] = "Speed changed"

• int sens\_rotation = 1

4\.6.1 Detailed Description

gère la commande du moteur

Author

Colin L, Lucas G

Version

1

Date

20 octobre 2023

4\.6.2 Function Documentation

4\.6.2.1 Change\_Speed()

void Change\_Speed (

char cmd[CMD\_BUFFER\_SIZE] )

Modiﬁe le rapport cyclique des PWM pour changer la vitesse de rotation du moteur.

Parameters

cmd[CMD\_BUFFER\_SIZE] buffer contenant la consigne du rapport cyclique

Returns

void

4\.6.2.2 Start\_Motor()

void Start\_Motor (

char cmd[CMD\_BUFFER\_SIZE] )

Démare les PWM avec une valeur de rapport cyclique de base de 500 pour assurer un vitesse de rotation nulle au

démarage.

Generated by Doxygen



<a name="br25"></a> 

4\.7 shell.c File Reference

19

Parameters

cmd[CMD\_BUFFER\_SIZE] buffer contenant la consigne du rapport cyclique qui va être initialisée

Returns

void

4\.6.2.3 Stop\_Motor()

void Stop\_Motor (

void

)

stop les PWM et donc arrête le moteur

Parameters

void

Returns

void

4\.7 shell.c File Reference

création du shell qui va permettre d'entrer les consignes du moteur

#include "shell.h"

#include "main.h"

#include "motor.h"

#include "adc\_mes.h"

#include <string.h>

#include <stdio.h>

Functions

• char ∗ UART\_Create\_Cmd (char ∗UART\_Create\_Cmd(void))

• void UART\_Echo (void)

Permet d'afﬁcher le caractère entré par l'utilisateur dans le shell.

Variables

• UART\_HandleTypeDef huart2

• const uint8\_t help [ ]

• const uint8\_t pinout [ ] = "PA8 : U\t\tPB13 : U\_barre\r\nPA9 : V\t\tPB14 : V\_barre\r\nBus\_Imes : PC2 (mesure

du courant)\r\nEncoder a : PA6\tEncoder b : PA4 (mesure de la vitesse)"

Generated by Doxygen



<a name="br26"></a> 

20

File Documentation

• const uint8\_t powerOn [ ] = "Powering on the motor"

• const uint8\_t powerOff [ ] = "Shutting down the motor"

• const uint8\_t speedChanged [ ] = "Changing speed"

• const uint8\_t cmdNotFound [ ] = "Command not found"

• const uint8\_t started [ ] = "Bienvenue dans ce super shell !"

• const uint8\_t courant [ ] = "Courant : "

• const uint8\_t courant\_txt\_ma [ ] = " mA"

• const uint8\_t vitesse\_txt [ ] = " tour/min"

• const uint8\_t newLine [ ] = "\r\n>>>"

• int idxCmd = 0

• char cmd [CMD\_BUFFER\_SIZE]

• char buffer\_cmd [1]

• char vitesse\_str [5]

• char courant\_str [5]

4\.7.1 Detailed Description

création du shell qui va permettre d'entrer les consignes du moteur

Author

Colin L, Lucas G

Version

1

Date

20 octobre 2023

4\.7.2 Function Documentation

4\.7.2.1 UART\_Echo()

void UART\_Echo (

void

)

Permet d'afﬁcher le caractère entré par l'utilisateur dans le shell.

Parameters

void

Returns

void

Generated by Doxygen



<a name="br27"></a> 

4\.8 stm32g4xx\_hal\_msp.c File Reference

4\.7.3 Variable Documentation

4\.7.3.1 help

21

const uint8\_t help[ ]

Initial value:

= "Liste des commandes\r\nhelp : donne la liste des commandes\r\npinout : donne la liste des broches

connectées\r\nstart : allume le moteur\r\nstop : eteint le moteur\r\n"

"speed : modifie la vitesse\r\ncourant : affiche le courant en mA\r\nvitesse : affiche la vitesse du

moteur"

4\.8 stm32g4xx\_hal\_msp.c File Reference

This ﬁle provides code for the MSP Initialization and de-Initialization codes.

#include "main.h"

Functions

• void HAL\_MspInit (void)

4\.8.1 Detailed Description

This ﬁle provides code for the MSP Initialization and de-Initialization codes.

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

4\.8.2 Function Documentation

4\.8.2.1 HAL\_MspInit()

void HAL\_MspInit (

void

)

Initializes the Global MSP. Disable the internal Pull-Up in Dead Battery pins of UCPD peripheral

Generated by Doxygen



<a name="br28"></a> 

22

File Documentation

4\.9 stm32g4xx\_hal\_timebase\_tim.c File Reference

HAL time base based on the hardware TIM.

#include "stm32g4xx\_hal.h"

#include "stm32g4xx\_hal\_tim.h"

Functions

• HAL\_StatusTypeDef HAL\_InitTick (uint32\_t TickPriority)

This function conﬁgures the TIM6 as a time base source. The time source is conﬁgured to have 1ms time base with

a dedicated Tick interrupt priority.

• void HAL\_SuspendTick (void)

Suspend Tick increment.

• void HAL\_ResumeTick (void)

Resume Tick increment.

Variables

• TIM\_HandleTypeDef htim6

4\.9.1 Detailed Description

HAL time base based on the hardware TIM.

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

4\.9.2 Function Documentation

4\.9.2.1 HAL\_InitTick()

HAL\_StatusTypeDef HAL\_InitTick (

uint32\_t TickPriority )

This function conﬁgures the TIM6 as a time base source. The time source is conﬁgured to have 1ms time base with

a dedicated Tick interrupt priority.

Note

This function is called automatically at the beginning of program after reset by HAL\_Init() or at any time when

clock is conﬁgured, by HAL\_RCC\_ClockConﬁg().

Generated by Doxygen



<a name="br29"></a> 

4\.9 stm32g4xx\_hal\_timebase\_tim.c File Reference

23

Parameters

TickPriority Tick interrupt priority.

Return values

HAL status

4\.9.2.2 HAL\_ResumeTick()

void HAL\_ResumeTick (

void

)

Resume Tick increment.

Note

Enable the tick increment by Enabling TIM6 update interrupt.

Parameters

None

Return values

None

4\.9.2.3 HAL\_SuspendTick()

void HAL\_SuspendTick (

void

)

Suspend Tick increment.

Note

Disable the tick increment by disabling TIM6 update interrupt.

Parameters

None

Return values

None

Generated by Doxygen



<a name="br30"></a> 

24

File Documentation

4\.10 stm32g4xx\_it.c File Reference

Interrupt Service Routines.

#include "main.h"

#include "stm32g4xx\_it.h"

#include "adc\_mes.h"

Functions

• void NMI\_Handler (void)

This function handles Non maskable interrupt.

• void HardFault\_Handler (void)

This function handles Hard fault interrupt.

• void MemManage\_Handler (void)

This function handles Memory management fault.

• void BusFault\_Handler (void)

This function handles Prefetch fault, memory access fault.

• void UsageFault\_Handler (void)

This function handles Undeﬁned instruction or illegal state.

• void SVC\_Handler (void)

This function handles System service call via SWI instruction.

• void DebugMon\_Handler (void)

This function handles Debug monitor.

• void PendSV\_Handler (void)

This function handles Pendable request for system service.

• void SysTick\_Handler (void)

This function handles System tick timer.

• void DMA1\_Channel1\_IRQHandler (void)

This function handles DMA1 channel1 global interrupt.

• void USART2\_IRQHandler (void)

This function handles USART2 global interrupt / USART2 wake-up interrupt through EXTI line 26.

• void EXTI15\_10\_IRQHandler (void)

This function handles EXTI line[15:10] interrupts.

• void TIM6\_DAC\_IRQHandler (void)

This function handles TIM6 global interrupt, DAC1 and DAC3 channel underrun error interrupts.

Variables

• DMA\_HandleTypeDef hdma\_adc1

• UART\_HandleTypeDef huart2

• TIM\_HandleTypeDef htim6

Generated by Doxygen



<a name="br31"></a> 

4\.11 syscalls.c File Reference

25

4\.10.1 Detailed Description

Interrupt Service Routines.

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

4\.11 syscalls.c File Reference

STM32CubeIDE Minimal System calls ﬁle.

#include <sys/stat.h>

#include <stdlib.h>

#include <errno.h>

#include <stdio.h>

#include <signal.h>

#include <time.h>

#include <sys/time.h>

#include <sys/times.h>

Functions

• int \_\_io\_putchar (int ch) \_\_attribute\_\_((weak))

• int \_\_io\_getchar (void)

• void initialise\_monitor\_handles ()

• int \_getpid (void)

• int \_kill (int pid, int sig)

• void \_exit (int status)

• \_\_attribute\_\_ ((weak))

• int \_close (int ﬁle)

• int \_fstat (int ﬁle, struct stat ∗st)

• int \_isatty (int ﬁle)

• int \_lseek (int ﬁle, int ptr, int dir)

• int \_open (char ∗path, int ﬂags,...)

• int \_wait (int ∗status)

• int \_unlink (char ∗name)

• int \_times (struct tms ∗buf)

• int \_stat (char ∗ﬁle, struct stat ∗st)

• int \_link (char ∗old, char ∗new)

• int \_fork (void)

• int \_execve (char ∗name, char ∗∗argv, char ∗∗env)

Variables

• char ∗∗ environ = \_\_env

Generated by Doxygen



<a name="br32"></a> 

26

File Documentation

4\.11.1 Detailed Description

STM32CubeIDE Minimal System calls ﬁle.

Author

Auto-generated by STM32CubeIDE

For more information about which c-functions

need which of these lowlevel functions

please consult the Newlib libc-manual

Attention

Copyright (c) 2020-2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

4\.12 sysmem.c File Reference

STM32CubeIDE System Memory calls ﬁle.

#include <errno.h>

#include <stdint.h>

Functions

• void ∗ \_sbrk (ptrdiff\_t incr)

\_sbrk() (p. 27) allocates memory to the newlib heap and is used by malloc and others from the C library

4\.12.1 Detailed Description

STM32CubeIDE System Memory calls ﬁle.

Author

Generated by STM32CubeIDE

For more information about which C functions

need which of these lowlevel functions

please consult the newlib libc manual

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

Generated by Doxygen



<a name="br33"></a> 

4\.13 system\_stm32g4xx.c File Reference

4\.12.2 Function Documentation

4\.12.2.1 \_sbrk()

27

void ∗ \_sbrk (

ptrdiff\_t incr )

\_sbrk() (p. 27) allocates memory to the newlib heap and is used by malloc and others from the C library

\* ############################################################################

\* # .data

\* #

\#

\#

.bss

\#

\#

newlib heap

\#

MSP stack

\#

\# Reserved by \_Min\_Stack\_Size #

\* ############################################################################

\* ^-- RAM start

^-- \_end

\_estack, RAM end --^

\*

This implementation starts allocating at the '\_end' linker symbol The '\_Min\_Stack\_Size' linker symbol reserves a

memory for the MSP stack The implementation considers '\_estack' linker symbol to be RAM end NOTE: If the MSP

stack, at any point during execution, grows larger than the reserved size, please increase the '\_Min\_Stack\_Size'.

Parameters

incr Memory size

Returns

Pointer to allocated memory

4\.13 system\_stm32g4xx.c File Reference

CMSIS Cortex-M4 Device Peripheral Access Layer System Source File.

#include "stm32g4xx.h"

Macros

• #deﬁne HSE\_VALUE 24000000U

• #deﬁne HSI\_VALUE 16000000U

Functions

• void SystemInit (void)

Setup the microcontroller system.

• void SystemCoreClockUpdate (void)

Update SystemCoreClock variable according to Clock Register Values. The SystemCoreClock variable contains the

core clock (HCLK), it can be used by the user application to setup the SysTick timer or conﬁgure other parameters.

Generated by Doxygen



<a name="br34"></a> 

28

File Documentation

Variables

• uint32\_t SystemCoreClock = HSI\_VALUE

• const uint8\_t AHBPrescTable [16] = {0U, 0U, 0U, 0U, 0U, 0U, 0U, 0U, 1U, 2U, 3U, 4U, 6U, 7U, 8U, 9U}

• const uint8\_t APBPrescTable [8] = {0U, 0U, 0U, 0U, 1U, 2U, 3U, 4U}

4\.13.1 Detailed Description

CMSIS Cortex-M4 Device Peripheral Access Layer System Source File.

Author

MCD Application Team

This ﬁle provides two functions and one global variable to be called from user application:

• SystemInit() (p. 7): This function is called at startup just after reset and before branch to main program. This

call is made inside the "startup\_stm32g4xx.s" ﬁle.

• SystemCoreClock variable: Contains the core clock (HCLK), it can be used by the user application to setup

the SysTick timer or conﬁgure other parameters.

• SystemCoreClockUpdate() (p. 7): Updates the variable SystemCoreClock and must be called whenever the

core clock is changed during program execution.

After each device reset the HSI (16 MHz) is used as system clock source. Then SystemInit() (p. 7) function is

called, in "startup\_stm32g4xx.s" ﬁle, to conﬁgure the system clock before to branch to main program.

4\.13.2 This ﬁle conﬁgures the system clock as follows:

4\.13.2.1 System Clock source | HSI

4\.13.2.2 SYSCLK(Hz) | 16000000

4\.13.2.3 HCLK(Hz) | 16000000

4\.13.2.4 AHB Prescaler | 1

4\.13.2.5 APB1 Prescaler | 1

4\.13.2.6 APB2 Prescaler | 1

4\.13.2.7 PLL\_M | 1

4\.13.2.8 PLL\_N | 16

4\.13.2.9 PLL\_P | 7

4\.13.2.10 PLL\_Q | 2

4\.13.2.11 PLL\_R | 2

4\.13.2.12 Require 48MHz for RNG | Disabled

\=============================================================================

Attention

Copyright (c) 2019 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

Generated by Doxygen



<a name="br35"></a> 

4\.14 tim.c File Reference

29

4\.14 tim.c File Reference

This ﬁle provides code for the conﬁguration of the TIM instances.

#include "tim.h"

Functions

• void MX\_TIM1\_Init (void)

• void MX\_TIM3\_Init (void)

• void HAL\_TIM\_PWM\_MspInit (TIM\_HandleTypeDef ∗tim\_pwmHandle)

• void HAL\_TIM\_Encoder\_MspInit (TIM\_HandleTypeDef ∗tim\_encoderHandle)

• void HAL\_TIM\_MspPostInit (TIM\_HandleTypeDef ∗timHandle)

• void HAL\_TIM\_PWM\_MspDeInit (TIM\_HandleTypeDef ∗tim\_pwmHandle)

• void HAL\_TIM\_Encoder\_MspDeInit (TIM\_HandleTypeDef ∗tim\_encoderHandle)

Variables

• TIM\_HandleTypeDef htim1

• TIM\_HandleTypeDef htim3

4\.14.1 Detailed Description

This ﬁle provides code for the conﬁguration of the TIM instances.

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

4\.14.2 Function Documentation

4\.14.2.1 HAL\_TIM\_Encoder\_MspDeInit()

void HAL\_TIM\_Encoder\_MspDeInit (

TIM\_HandleTypeDef ∗ tim\_encoderHandle )

TIM3 GPIO Conﬁguration PA4 ---—> TIM3\_CH2 PA6 ---—> TIM3\_CH1 PC8 ---—> TIM3\_CH3

4\.14.2.2 HAL\_TIM\_Encoder\_MspInit()

void HAL\_TIM\_Encoder\_MspInit (

TIM\_HandleTypeDef ∗ tim\_encoderHandle )

TIM3 GPIO Conﬁguration PA4 ---—> TIM3\_CH2 PA6 ---—> TIM3\_CH1 PC8 ---—> TIM3\_CH3

4\.14.2.3 HAL\_TIM\_MspPostInit()

void HAL\_TIM\_MspPostInit (

TIM\_HandleTypeDef ∗ timHandle )

TIM1 GPIO Conﬁguration PB13 ---—> TIM1\_CH1N PB14 ---—> TIM1\_CH2N PB15 ---—> TIM1\_CH3N PA8 ---—

\> TIM1\_CH1 PA 9 ---—> TIM1\_CH2 PA10 ---—> TIM1\_CH3

4\.15 usart.c File Reference

This ﬁle provides code for the conﬁguration of the USART instances.

#include "usart.h"

Generated by Doxygen



<a name="br36"></a> 

30

File Documentation

Functions

• void MX\_USART2\_UART\_Init (void)

• void MX\_USART3\_UART\_Init (void)

• void HAL\_UART\_MspInit (UART\_HandleTypeDef ∗uartHandle)

• void HAL\_UART\_MspDeInit (UART\_HandleTypeDef ∗uartHandle)

Variables

• UART\_HandleTypeDef huart2

• UART\_HandleTypeDef huart3

4\.15.1 Detailed Description

This ﬁle provides code for the conﬁguration of the USART instances.

Attention

Copyright (c) 2023 STMicroelectronics. All rights reserved.

This software is licensed under terms that can be found in the LICENSE ﬁle in the root directory of this software

component. If no LICENSE ﬁle comes with this software, it is provided AS-IS.

4\.15.2 Function Documentation

4\.15.2.1 HAL\_UART\_MspDeInit()

void HAL\_UART\_MspDeInit (

UART\_HandleTypeDef ∗ uartHandle )

USART2 GPIO Conﬁguration PA2 ---—> USART2\_TX PA3 ---—> USART2\_RX

USART3 GPIO Conﬁguration PC10 ---—> USART3\_TX PC11 ---—> USART3\_RX

4\.15.2.2 HAL\_UART\_MspInit()

void HAL\_UART\_MspInit (

UART\_HandleTypeDef ∗ uartHandle )

Initializes the peripherals clocks

USART2 GPIO Conﬁguration PA2 ---—> USART2\_TX PA3 ---—> USART2\_RX

Initializes the peripherals clocks

USART3 GPIO Conﬁguration PC10 ---—> USART3\_TX PC11 ---—> USART3\_RX

Generated by Doxygen



<a name="br37"></a> 

Index

\_sbrk

usart.c, 30

sysmem.c, 27

HAL\_UART\_MspInit

usart.c, 30

adc.c, 9

HAL\_ADC\_MspDeInit, 10

HAL\_UART\_RxCpltCallback

main.c, 16

HAL\_ADC\_MspInit, 10

MX\_ADC1\_Init, 10

MX\_ADC2\_Init, 10

help

shell.c, 21

HSE\_VALUE

Adc\_init

adc\_mes.c, 12

adc\_mes.c, 11

STM32G4xx\_System\_Private\_Includes, 6

HSI\_VALUE

STM32G4xx\_System\_Private\_Includes, 6

Adc\_init, 12

Mes\_Courant, 12

Mesure\_Vitesse, 12

main

main.c, 17

main.c, 14

Change\_Speed

motor.c, 18

CMSIS, 5

Error\_Handler, 15

HAL\_ADC\_ConvCpltCallback, 16

HAL\_TIM\_PeriodElapsedCallback, 16

HAL\_UART\_RxCpltCallback, 16

main, 17

dma.c, 13

MX\_DMA\_Init, 13

SystemClock\_Conﬁg, 17

Mes\_Courant

adc\_mes.c, 12

Mesure\_Vitesse

adc\_mes.c, 12

motor.c, 17

Error\_Handler

main.c, 15

gpio.c, 13

MX\_GPIO\_Init, 14

Change\_Speed, 18

Start\_Motor, 18

Stop\_Motor, 19

MX\_ADC1\_Init

adc.c, 10

HAL\_ADC\_ConvCpltCallback

main.c, 16

HAL\_ADC\_MspDeInit

adc.c, 10

HAL\_ADC\_MspInit

adc.c, 10

MX\_ADC2\_Init

adc.c, 10

HAL\_InitTick

MX\_DMA\_Init

stm32g4xx\_hal\_timebase\_tim.c, 22

HAL\_MspInit

stm32g4xx\_hal\_msp.c, 21

HAL\_ResumeTick

stm32g4xx\_hal\_timebase\_tim.c, 23

HAL\_SuspendTick

stm32g4xx\_hal\_timebase\_tim.c, 23

HAL\_TIM\_Encoder\_MspDeInit

tim.c, 29

dma.c, 13

MX\_GPIO\_Init

gpio.c, 14

shell.c, 19

help, 21

UART\_Echo, 20

Start\_Motor

motor.c, 18

stm32g4xx\_hal\_msp.c, 21

HAL\_MspInit, 21

stm32g4xx\_hal\_timebase\_tim.c, 22

HAL\_InitTick, 22

HAL\_ResumeTick, 23

HAL\_SuspendTick, 23

stm32g4xx\_it.c, 24

HAL\_TIM\_Encoder\_MspInit

tim.c, 29

HAL\_TIM\_MspPostInit

tim.c, 29

HAL\_TIM\_PeriodElapsedCallback

main.c, 16

HAL\_UART\_MspDeInit

Generated by Doxygen



<a name="br38"></a> 

32

INDEX

Stm32g4xx\_system, 5

STM32G4xx\_System\_Private\_Deﬁnes, 6

STM32G4xx\_System\_Private\_FunctionPrototypes, 6

STM32G4xx\_System\_Private\_Functions, 6

SystemCoreClockUpdate, 7

SystemInit, 7

STM32G4xx\_System\_Private\_Includes, 5

HSE\_VALUE, 6

HSI\_VALUE, 6

STM32G4xx\_System\_Private\_Macros, 6

STM32G4xx\_System\_Private\_TypesDeﬁnitions, 6

STM32G4xx\_System\_Private\_Variables, 6

Stop\_Motor

motor.c, 19

syscalls.c, 25

sysmem.c, 26

\_sbrk, 27

system\_stm32g4xx.c, 27

SystemClock\_Conﬁg

main.c, 17

SystemCoreClockUpdate

STM32G4xx\_System\_Private\_Functions, 7

SystemInit

STM32G4xx\_System\_Private\_Functions, 7

tim.c, 29

HAL\_TIM\_Encoder\_MspDeInit, 29

HAL\_TIM\_Encoder\_MspInit, 29

HAL\_TIM\_MspPostInit, 29

UART\_Echo

shell.c, 20

usart.c, 29

HAL\_UART\_MspDeInit, 30

HAL\_UART\_MspInit, 30

Generated by Doxygen

